# Filter

## fir_filter.sv
### acc += mult; &rarr; ì§ë ¬ë°©ì‹ : delay ì¦ê°€
```SystemVerilog
`timescale 1ns/1ps

module fir_filter (
    input  logic clk,
    input  logic rst_n,
    input  logic signed [6:0] din,         // Q1.6 ì…ë ¥
    output logic signed [6:0] dout         // Q1.6 ì¶œë ¥
);

    parameter TAP = 33;

    // Q1.8 fixed-point RRC coefficients (signed 9-bit)
    localparam signed [8:0] COEFF [0:TAP-1] = '{
         0,  -1,   1,   0,  -1,   2,   0,  -2,   2,   0,
        -6,   8,  10, -28, -14, 111, 196, 111, -14, -28,
        10,   8,  -6,   0,   2,  -2,   0,   2,  -1,   0,
         1,  -1,   0
    };

    // Shift register for input samples (Q1.6)
    logic signed [6:0] shift_reg [0:TAP-1];

    // Accumulator: 7b * 9b = 16b â†’ sum â†’ 32b ì •ìˆ˜
    logic signed [31:0] acc;

    // Intermediate output before final FF
    logic signed [6:0] dout_next;

    // Shift register: ì…ë ¥ ìƒ˜í”Œ ì´ë™
    always_ff @(posedge clk or negedge rst_n) begin
        if (!rst_n) begin
            for (int i = 0; i < TAP; i++) shift_reg[i] <= 0;
        end else begin
            shift_reg[0] <= din;
            for (int i = 1; i < TAP; i++)
                shift_reg[i] <= shift_reg[i - 1];
        end
    end

    // FIR ì—°ì‚° (multiply-accumulate) â€” Q1.6 Ã— Q1.8 = Q2.14 ëˆ„ì 
    always_comb begin
        acc = 0;
        for (int i = 0; i < TAP; i++) begin
            logic signed [15:0] mult;
            mult = $signed(shift_reg[i]) * $signed(COEFF[i]);  // Q1.6 * Q1.8 = Q2.14
            acc += mult;   //delay ì‹¬í•œ ë°©ì‹ -> ë³‘ë ¬ë¡œ ìˆ˜ì • í•„ìš”
        end
    end

    // ë¼ìš´ë”© ë° í´ë¦¬í•‘: Q2.14 â†’ Q1.6
    always_ff @(posedge clk or negedge rst_n) begin
        if (!rst_n) begin
            dout_next <= 0;
        end else begin
            logic signed [15:0] rounded;
            rounded = acc >>> 8;  // +0.5 (128) for rounding â†’ shift 8 â†’ Q1.6

            // Saturation (Clip to [-64, +63])
            if (rounded > 63)
                dout_next <= 63;
            else if (rounded < -64)
                dout_next <= -64;
            else
                dout_next <= rounded[6:0];
        end
    end

    // ìµœì¢… ì¶œë ¥ FF (íƒ€ì´ë° ì•ˆì •ìš©)
    always_ff @(posedge clk or negedge rst_n) begin
        if (!rst_n)
            dout <= 0;
        else
            dout <= dout_next;
    end
endmodule
```

## fir_filter.sv 
### array ì‚¬ìš© : ë³‘ë ¬ ë°©ì‹ìœ¼ë¡œ delay ê°ì†Œ

## tb_fir_filter.sv
```SystemVerilog
`timescale 1ns/1ps

module tb_fir_filter;

    logic clk, rst_n;
    logic signed [6:0] din;
    logic signed [6:0] dout;

    fir_filter dut (
        .clk(clk),
        .rst_n(rst_n),
        .din(din),
        .dout(dout)
    );

    // Clock
    initial clk = 0;
    always #5 clk = ~clk;

    // File handles
    integer fd_in, fd_out, r;
    int cycle = 0;
    int max_print = 46500;  // ì „ì²´ì˜ ì ˆë°˜ ì •ë„ë§Œ í™”ë©´ì— ì¶œë ¥

    initial begin
        $dumpfile("tb_fir_filter.vcd");
        $dumpvars(0, tb_fir_filter);

        rst_n = 0;
        din = 0;
        #20 rst_n = 1;

        fd_in = $fopen("input_vector.txt", "r");
        fd_out = $fopen("output_vector.txt", "w");

        if (fd_in == 0 || fd_out == 0) begin
            $display("âŒ íŒŒì¼ ì—´ê¸° ì‹¤íŒ¨!");
            $finish;
        end

        while (!$feof(fd_in)) begin
            r = $fscanf(fd_in, "%d\n", din);
            #10;
            $fwrite(fd_out, "%0d\n", dout);
            if (cycle < max_print)
                $display("[%0t ns] din = %0d, dout = %0d", $time, din, dout);
            cycle++;
        end

        $fclose(fd_in);
        $fclose(fd_out);
        $display("âœ… ì´ %0dê°œì˜ ë²¡í„° ì²˜ë¦¬ ì™„ë£Œ", cycle);
        $display("ğŸ“‚ output_vector.txt íŒŒì¼ì—ì„œ ì „ì²´ ì¶œë ¥ ê²°ê³¼ í™•ì¸ ê°€ëŠ¥");
        #100;
        $finish;
    end

endmodule

```
-----------------
### filter ê²°ê³¼ - MATLAB(wave1)   
<img src = "./img/250716_wave1.png"><br>
- ê³ ì£¼íŒŒëŠ” ë§‰ê³ , ì €ì£¼íŒŒëŠ” í†µê³¼ì‹œí‚¤ëŠ” í•„í„°
- ì˜ˆìƒê°’ê³¼ ì‹¤ì œ ë‚˜ì˜¨ ê°’ ë¹„êµ

-----------
### filter ê²°ê³¼ - wave2
<img src = "./img/250716_wave2.png"><br>
- ì¤‘ì‹¬ ì¶• 0, ì‚¬ì´ë“œ ì œí•œ 0.5 (ìƒ˜í”Œë§ ë‘ë°°)
--------------
### filter ê²°ê³¼ - wave3
<img src = "./img/250716_wave3.png"><br>
- 2ë²ˆ wave (ìœ„ì˜ wave)ì™€ ê°™ìŒ

-------------------------------------------
ë‹¤ìŒì€ `Project_1_stu.pdf`ì˜ ë‚´ìš©ì„ **ìš”ì•½í•œ Markdown í˜•ì‹**ì…ë‹ˆë‹¤:

---

## Project #1 ìš”ì•½

### ëª©í‘œ
- ì›ì¹˜ ì•ŠëŠ” ì£¼íŒŒìˆ˜ ì„±ë¶„(ë…¸ì´ì¦ˆ)ì„ ì œê±°í•˜ê¸° ìœ„í•œ **í•„í„° íšŒë¡œ** ì„¤ê³„
- ì£¼ìš” ëª©ì : íŠ¹ì • ì£¼íŒŒìˆ˜ ì°¨ë‹¨ ë˜ëŠ” í†µê³¼

---

### 1. Filter ê°œìš”
- **ì‘ìš© ë¶„ì•¼**: ì „ì/ì „ê¸° íšŒë¡œ, ìŒì„±/ì˜ìƒ ì²˜ë¦¬, í†µì‹  ì‹œìŠ¤í…œ
- **ì €ì—­í†µê³¼í•„í„° (LPF)**:
  - ì €ì£¼íŒŒ í†µê³¼ / ê³ ì£¼íŒŒ ì°¨ë‹¨
  - A/D ë³€í™˜ê¸°ì—ì„œ í•„ìˆ˜ ì‚¬ìš©ë¨

---

### 2. Convolution
- ì´ì‚°-ì‹œê°„ ì»¨ë³¼ë£¨ì…˜ (Discrete-Time Convolution)
- FIR í•„í„° êµ¬í˜„ì— ì‚¬ìš©ë¨   
<img src = "./img/250716_convolution.png"><br>   


---

### 3. FIR í•„í„°
- **FIR (Finite Impulse Response)**: ìœ í•œ ê¸¸ì´ì˜ ì„í„ìŠ¤ ì‘ë‹µ
- LPF ì„¤ê³„ì— ì í•©   
- <img src = "./img/250716_FIR.png"><br>

---

### 4. RRC í•„í„° (Root Raised Cosine)
- **ì •ìˆ˜ê³„ìˆ˜ (Fixed point, <1.8>)**
- **ë¶€ë™ì†Œìˆ˜ì ê³„ìˆ˜ (Floating point)**   
<img src = "./img/250716_fixed_point.png"><br>   

ì˜ˆ: floating : 7.625 â†’ fixed : 0000011110100000 (<8.8> í¬ë§·)   

<img src = "./img/250716_RRC_filter_coefficient.png"><br>   
---

### 5. ì‹œë®¬ë ˆì´ì…˜
- **Matlab ê²°ê³¼ í”Œë¡¯**    
<img src = "./img/250716_simulation.png"><br>   
---

### 6. Matlab í™˜ê²½
- ì œê³µ: Mathworks
- ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜(m-file), í–‰ë ¬ ì—°ì‚° ìµœì í™”
- ì‚¬ìš© ì‰¬ì›€, ì»´íŒŒì¼ ê´€ëŒ€, C/C++ë³´ë‹¤ ëŠë¦¼
